{{define "event-user"}}
<div class="event">
    <div class="timestamp">{{.Timestamp}}</div>
    <div class="user-message">
        <strong>User:</strong> {{.Message}}
    </div>
</div>
{{end}}

{{define "event-final"}}
<div class="event">
    <div class="timestamp">{{.Timestamp}}</div>
    <div class="assistant-message">
        <strong>Assistant:</strong> {{.Text}}
    </div>
</div>
{{end}}

{{define "event-tool-use"}}
<div class="event">
    <div class="timestamp">{{.Timestamp}}</div>
    <div class="tool-call">
        <strong>Tool Call:</strong> {{.Name}}
        <pre>{{.Input | toJson}}</pre>
    </div>
</div>
{{end}}

{{define "event-tool-result"}}
<div class="event">
    <div class="timestamp">{{.Timestamp}}</div>
    <div class="tool-result">
        <strong>Tool Result:</strong>
        <pre>{{.Result}}</pre>
    </div>
</div>
{{end}}

{{define "conversation-history"}}
    {{range .Messages}}
        {{$timestamp := .Time.Format "15:04:05"}}
        {{if eq .Type "chat"}}
            {{if eq .Content.Role "user"}}
                {{template "event-user" dict "Timestamp" $timestamp "Message" .Content.Text}}
            {{else}}
                {{template "event-final" dict "Timestamp" $timestamp "Text" .Content.Text}}
            {{end}}
        {{else if eq .Type "tool-use"}}
            {{template "event-tool-use" dict "Timestamp" $timestamp "Name" .Content.Name "Input" .Content.Input}}
        {{else if eq .Type "tool-result"}}
            {{template "event-tool-result" dict "Timestamp" $timestamp "Result" .Content.Result}}
        {{end}}
    {{end}}
{{end}}

{{define "message-container"}}
<div class="message-group">
    {{if eq .Type "chat"}}
        {{if eq .Content.Role "user"}}
            {{template "event-user" dict "Timestamp" (.Time.Format "15:04:05") "Message" .Content.Text}}
        {{else}}
            {{template "event-final" dict "Timestamp" (.Time.Format "15:04:05") "Text" .Content.Text}}
        {{end}}
    {{else if eq .Type "tool-use"}}
        {{template "event-tool-use" dict "Timestamp" (.Time.Format "15:04:05") "Name" .Content.Name "Input" .Content.Input}}
    {{else if eq .Type "tool-result"}}
        {{template "event-tool-result" dict "Timestamp" (.Time.Format "15:04:05") "Result" .Content.Result}}
    {{end}}
</div>
{{end}} 